variant: openshift
version: 4.9.0
metadata:
  name: 99-worker-dummy
  labels:
    machineconfiguration.openshift.io/role: worker
passwd:
  users:
    - name: core
      ssh_authorized_keys:
        - ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key
systemd:
  units:
  - name: vagrant.service
    enabled: true
    contents: |
      [Unit]
      Description=Setup root login and empty password for Vagrant
      After=network.target cdsshd.service

      [Service]
      Type=oneshot
      ExecStart=/usr/bin/sed -i 's/PermitRootLogin no/PermitRootLogin yes/g' /etc/ssh/sshd_config
      ExecStart=/usr/bin/sed -i 's/#PermitEmptyPasswords no/PermitEmptyPasswords yes/g' /etc/ssh/sshd_config
      ExecStart=/usr/bin/systemctl restart sshd.service
      RemainAfterExit=true
      StandardOutput=journal
      RemainAfterExit=yes

      [Install]
      WantedBy=multi-user.target